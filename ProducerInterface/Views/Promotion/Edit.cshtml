
@{
    ViewBag.Title = (Model != null && Model.Id != 0 ? "Редактирование акции" : "Добавление акции");
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div class="container" id="PromotionEditDiv" name="PromotionEditDiv">

    <div class="row">
        <div class="col-xs-12">
            <h3 data-bind="text: Title"></h3>
        </div>
    </div>

    <input hidden="hidden" id="PromotionId" name="PromotionId" value="@ViewBag.PromotionId" />
    
    <div class="row">
        <div class="col-xs-12">
            <div class="row">
                <form action="@Url.Action("EditSave")" method="post" data-bind="event:{submit: Validation}" enctype="multipart/form-data">
                    <input type="text" id="Id" name="Id" data-bind="value: Id" hidden="hidden"/>

                    <div class="col-xs-12">
                        <div class="form-group">
                            <label>Наименование акции <strong data-bind="text: NameLight" class="text-info"></strong></label>
                            <input type="text" data-bind="value: Name, valueUpdate: 'afterkeydown', event:{keyup: Event_Name}" id="Name" name="Name" class="form-control" />
                            <span class="field-validation-error" data-bind="text: NameError"></span>
                        </div>
                    </div>

                    <div class="col-xs-12">
                        <div class="form-group">
                            <label>Аннотация <strong class="text-info" data-bind="text: AnnotationLight"></strong></label>
                            <textarea rows="5" id="Annotation" name="Annotation" data-bind="value: Annotation, valueUpdate: 'afterkeydown', event:{keyup: Event_Annotation}" class="form-control" typeof="input"></textarea>
                            <span class="field-validation-error" data-bind="text: AnnotationError"></span>
                        </div>
                    </div>

                    <div class="col-xs-12">
                        <div class="form-group">
                            <label>Список препаратов</label>
                            <select typeod="input" id="DrugList" name="DrugList" multiple="" hidden="hidden" data-bind="foreach: DrugCatalogList, selectedOptions: DrugList, event: {change: Event_DrudList}" class="drop">
                                <option data-bind="text: Text, value: Value"></option>
                            </select>
                            <span class="field-validation-error" data-bind="text: DrugListError"></span>
                        </div>
                    </div>


                    <div class="col-xs-12">
                        <div class="form-group">
                            <label>Список регионов</label>
                            <select typeof="input" multiple="" id="RegionList" name="RegionList" hidden="hidden"  data-bind="foreach: RegionGlobalList, selectedOptions: RegionList,  event: {change: Event_RegionList}"  class="drop">
                                <option data-bind="text: Text, value: Value"></option>
                            </select>
                            <span class="field-validation-error" data-bind="text: RegionListError"></span>
                        </div>
                    </div>

                    <div class="col-xs-12">
                        <div class="form-group">
                            <label>Список поставщиков</label>
                            <label class="checkbox text-info">
                                <input type="checkbox" data-bind="checked: AllSupplier, event: {change: Event_AllSupplier}" /> Отметить всех поставщиков в выбранных регионах
                            </label>                           

                            <select multiple="" hidden="hidden" data-bind="foreach: SuppierRegionsList, selectedOptions: SuppierRegions, event: {change: Event_SuppierRegions}" id="SuppierRegions" name="SuppierRegions" class="drop">                               
                                <option data-bind="text: Text, value: Value"></option>
                            </select>
                            <span class="field-validation-error" data-bind="text: SuppierRegionsError"></span>
                        </div>
                    </div>

                    <div class="row">

                        <div class="col-xs-6">
                            <div class="col-xs-12">
                                <div class="form-group">
                                    <label>Дата начала акции</label>
                                    <input type="text" id="Begin" name="Begin" data-bind="value: Begin" class="form-control" readonly />
                                    <span class="field-validation-error" data-bind="text: BeginError"></span>
                                </div>
                            </div>
                        </div>

                        <div class="col-xs-6">
                            <div class="col-xs-12">
                                <div class="form-group">
                                    <label>Дата окончания акции</label>
                                    <input type="text" id="End" name="End" data-bind="value: End" class="form-control" readonly />
                                    <span class="field-validation-error" data-bind="text: EndError"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xs-12">
                        <div class="form-group">
                            <label>Прикреплённый файл</label>
                            <a data-bind="text: PromotionFileName, attr: { href: PromotionFileUrl} "></a>
                            <br />  <label>Добавление файла</label>
                            <input name="File" id="File" type="file" accept="image/jpeg,image/png,text/plain" class="form-control">
                            <span class="field-validation-error" data-bind="text: FileError"></span>
                        </div>
                    </div>

                    <div class="col-xs-12">
                        <div class="form-group">

                            <input type="submit" class="btn btn-primary" data-bind="value: SubmitText" />
                        </div>
                    </div>

                </form>
            </div>
        </div>
    </div>
</div>

@section styles
        {
    <link href="~/Content/bootstrap-datepicker.min.css" rel="stylesheet" />
    <link href="~/Content/FileUpload.css" rel="stylesheet" />
}

@section JavaScript
{
    <script src="~/Scripts/knockout-3.4.0.js"></script>
    <script src="~/Scripts/knockout-3.4.0.debug.js"></script>
    <script src="~/Scripts/bootstrap-datepicker.min.js"></script> 
<script src="~/Scripts/WorkPlace/Promotion_Edit_Model.js"></script>
    <script src="~/Scripts/WorkPlace/Promotion_Edit.js"></script>
<script src="~/Scripts/WorkPlace/FileUpLoad.js"></script>
}